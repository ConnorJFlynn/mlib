function Q_tsi = flow_STAP_to_TSI(Q_stap)
% Q_tsi = flow_STAP_to_TSI(Q_stap)

A(1,1) = 1.4; B(1) = {[1.29, 1.3, 1.28, 1.29, 1.27, 1.28, 1.29, 1.29, 1.28]};
A(2,1) = 1.3; B(2) = {[1.2, 1.2, 1.2, 1.23, 1.19, 1.2, 1.21, 1.23, 1.2, 1.21]};
A(3,1) = 1.2; B(3) = {[1.13, 1.13, 1.11, 1.14, 1.13, 1.13, 1.12, 1.12, 1.12, 1.13, 1.13, 1.13]};
A(4,1) = 1.1; B(4) = {[.99, .98, .94, .95, .98, 1, .99, .98, .95, .98]};
A(5,1) = 1.0; B(5) = {[.95, .82, .87, .88, .93, .88, .82, .87, .93, .90, .81, .89, .81, .88, .86]};
A(6,1) = .9;  B(6) = {[.73 .84 .76 .78 .74 .80 .73 .72 .72 .73 .80 .79 .78 .78 .70 .77 .79]};
A(7,1) = .8;  B(7) = {[.66 .70 .75 .65 .66 .67 .76 .69 .76 .67 .73 .68 .68 .74 .66 .68 .74 .66 .68 .66 .70 .73 .69]};
A(8,1) = .7; B(8) = {[.62 .53 .62 .64 .54 .58 .57 .53 .53 .62 .61 .60 .62 .60 .62 .59 .61 .53 .57 .56]};

for bb = 1:length(B)
    A(bb,2) = mean(B{bb});
end
P1 = polyfit(A(:,1), A(:,2), 1);
P2 = polyfit(A(:,1), A(:,2), 2);
figure; plot(A(:,1), A(:,2), 'o-',A(:,1), polyval(P1, A(:,1)), 'r-', A(:,1), polyval(P2, A(:,1)), 'k-');

Q_tsi = polyval(P1, Q_stap);

return