function wvmr=mrcal(t,rh,p)

lev=max(size(t));
for i=1:lev
    if(t(i)>253.15)
   A0=.999996876D0;
   A1=-.9082695004D-2;
   A2=.7873616869D-4;
   A3=-.6111795727D-6;
   A4=.4388418740D-8;
   A5=-.2988388486D-10;          
   A6=.2187442495D-12;
   A7=-.1789232111D-14;
   A8=.1111201803D-16;
   A9=-.3099457145D-19;
   B=.61078D+1;                                     
   T=t(i)-273.16;                                                           
   S=A0+T*(A1+T*(A2+T*(A3+T*(A4+T*(A5+T*(A6+T*(A7+T*(A8+T*A9))))))));       
   es(i)=B/S^8;
    else
   A0=.7859063157D0;
   A1=.3579242320D-1;
   A2=-.1292820828D-3;          
   A3=.5937519208D-6;
   A4=.4482949133D-9;
   A5=.2176664827D-10;          
   T=t(i)-273.16;                                                           
   E=A0+T*(A1+T*(A2+T*(A3+T*(A4+T*A5))));                                   
   es(i)=10.^E;                                                           
    end
  satmr=622*es(i)/(p(i)-es(i));
  wvmr(i)=satmr*rh(i)/100;
%   if rh(i)> 100
%       rh(i)=100;
%   end
    
end
end
